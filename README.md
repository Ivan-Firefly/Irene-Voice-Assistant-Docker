# Docker версия для ARM голосового ассистента Ирина

Тут будут описаны только отличия от оригинального репозитория - общее описание, концепцию, доп. плагины - см. тут https://github.com/janvarev/Irene-Voice-Assistant

В качестве "говорилки" (TTS) выбрал **vosk-tts**, ему должно хватать небольших ресурсов малин/апельсин для генерации голоса с приемлемой задержкой и более-менее адекватным качеством.

В паке `docker_plugins` сложил минимально необходимый набор плагинов (по моим представлениям). Дополнительные плагины можно закинуть в эту же папку и они подтянуться в контейнер. Советую предварительно посмотреть используемые библиотеки и зависимости, которые используются в новых плагинах. Для их утсановки нужно пересобрать контейнер, предварительно добавив в `requirements-docker.txt`.

Относительно оригинала изменились:
  1. `Dockerfile`
  2. `plugin_tts_console.py` - убран лишний импорт библиотеки pyttsx
  3. `requirements-docker.txt` - оставлен минимальный набор библиотек

Добавлен `docker-compose.yml` для удобного запуска контейнера. После старта, в текущей директории создается папка `irene_options`, куда выносятся основные настройки Ирины и запущеных плагинов.

Первый запуск контейнера может быть долгим (будет скачиваться модель vosk-model-tts-ru) и он пройдет с ошибками:
```
irene-va-docker  | Traceback (most recent call last):
irene-va-docker  |   File "/home/python/irene/vacore.py", line 143, in setup_assistant_voice
irene-va-docker  |     self.playwavs[self.playWavEngineId][0](self)
irene-va-docker  | KeyError: 'consolewav'
```
- это нормально. Нужно остановить контейнер, раскомментировать последнюю строчку в разделе **volumes** в `docker-compose.yml`:

```# - /va/runva_webapi.json:/home/python/irene/runva_webapi.json #настройки web сервера```

Финальный шаг - в автоматически созданной папке `irene_options` в `core.json` выставить настройки:
1.  ```"playWavEngineId": "sounddevice" ```
2.  ```"ttsEngineId": "vosk"```

Повторно запускаем контейнер, должен быть быстрый страт без ошибок.
